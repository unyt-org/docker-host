# see https://depth-first.com/articles/2019/10/16/compiling-c-to-webassembly-and-running-it-without-emscripten/
# https://surma.dev/things/c-to-webassembly/

# https://github.com/WebAssembly/wasi-sdk

# using libc++.a, ... from /wasi-sdk-12.0/share/wasi-sysroot/lib/wasm32-wasi (in /tmp/wasi-libc/lib/wasm32-wasi)

clang --target=wasm32-unknown-wasi --sysroot /tmp/wasi-libc -nostartfiles -Wl,--import-memory -Wl,--no-entry -Wl,--export-all -Wl,--allow-undefined -o datex_runtime.wasm datex_runtime_for_wasm.cpp


# working for c++ (no exceptions for now)
/home/unyt/wasi-sdk-12.0/bin/clang++ --target=wasm32-wasi --sysroot=${WASI_SDK_PATH}/share/wasi-sysroot -nostartfiles -fno-exceptions -Wl,--import-memory -Wl,--no-entry -Wl,--export-all -Wl,--allow-undefined-file=wasm-import.syms  -o datex_runtime.wasm datex_runtime_for_wasm.cpp